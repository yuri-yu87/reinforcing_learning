# 信号功率与发射功率预算关系图绘制工具 - 使用说明

## 功能特点

✅ **多用户场景**：支持K = 1, 2, 3, 4个用户的对比分析  
✅ **功率预算分析**：发射功率从0.1W到2.0W的完整范围  
✅ **考虑噪声影响**：接收功率计算包含信号功率和噪声功率  
✅ **环境约束**：严格遵循UAV在z=50m，User在z=0m的限制  
✅ **智能用户分布**：根据用户数量自动优化用户位置分布  
✅ **双对数图支持**：提供普通坐标和双对数坐标两种显示方式  

## 快速使用

### 方法1：直接运行（推荐）
```bash
python plot_signal_power_vs_transmit_power.py
```

这将：
1. 为每个K值计算不同发射功率下的总接收功率
2. 自动生成综合对比图
3. 保存为 `results/signal_power_vs_transmit_power_all_K.png`
4. 显示详细统计信息

### 方法2：程序调用
```python
from plot_signal_power_vs_transmit_power import main

# 运行完整分析
all_results, figure = main()

# 查看结果
for K in [1, 2, 3, 4]:
    powers = all_results[K]['received_powers_total_db']
    print(f"K={K}: 平均接收功率 {powers.mean():.1f} dB")
```

### 方法3：自定义参数
```python
from plot_signal_power_vs_transmit_power import plot_signal_power_vs_transmit_power, plot_6_2

# 收集不同K值的结果
results = {}
for K in [1, 2, 3, 4]:
    results[K] = plot_signal_power_vs_transmit_power(
        K=K,
        transmit_power_range=(0.05, 5.0),  # 自定义功率范围
        num_power_points=100,  # 更多采样点
        path_loss_exponent=3.0  # 不同的路径损耗指数
    )

# 绘制综合图
plot_6_2(results, save_path="my_custom_transmit_power_plot.png")
```

## 技术细节

### 环境设置
- **环境边界**：100m × 100m × 50m
- **UAV位置**：(0, 0, 50) - 原点上方50m
- **用户分布策略**：
  - K=1: 环境中心 (50, 50, 0)
  - K=2: 对角线分布 (25,25,0), (75,75,0)
  - K=3: 三角形分布 (25,25,0), (75,25,0), (50,75,0)
  - K=4: 四角分布 (25,25,0), (75,25,0), (25,75,0), (75,75,0)

### 物理模型
- **信道模型**：LoS路径损耗 + 复数相位
- **接收功率**：P_rx = P_tx × |h|² + σ²（信号+噪声）
- **总接收功率**：所有用户接收功率的总和
- **噪声功率**：-100 dB（固定）
- **路径损耗指数**：η = 2.5

### 输出文件
- `results/signal_power_vs_transmit_power_all_K.png` - 主要结果图
- 包含所有K值的曲线，X轴为对数坐标
- 清晰的图例和坐标轴标签

### 双对数图功能
- `results/signal_power_vs_distance_all_eta_log_log.png` - 双对数坐标图
- X轴和Y轴都使用对数坐标
- Y轴显示线性功率值（W），便于观察功率变化趋势
- 适合分析功率与距离的数学关系

## 结果解读

### 典型结果：
```
K = 1: 平均接收功率 -88.7 dB, 功率效率 -88.0 dB/W
K = 2: 平均接收功率 -84.3 dB, 功率效率 -83.6 dB/W  
K = 3: 平均接收功率 -83.0 dB, 功率效率 -82.3 dB/W
K = 4: 平均接收功率 -82.3 dB, 功率效率 -81.5 dB/W
```

### 趋势分析：
- **用户数量影响**：K越大，总接收功率越高（更多用户）
- **功率效率**：K越大，功率效率越好（更有效的功率利用）
- **线性关系**：接收功率与发射功率呈近似线性关系（dB尺度）
- **对数坐标**：X轴使用对数坐标更好地显示功率变化

### 物理意义：
1. **多用户增益**：增加用户数量可以提高总接收功率
2. **功率预算优化**：帮助确定最优发射功率分配
3. **系统容量**：为多用户系统设计提供参考

## 代码架构

```
plot_signal_power_vs_transmit_power()  # 计算单个K值
    ├── 生成用户位置分布
    ├── 计算信道系数（固定）
    ├── 扫描发射功率范围
    ├── 计算总接收功率
    └── 返回结构化结果

plot_6_2()                            # 绘制综合图表
    ├── 整合所有K值数据
    ├── 绘制功率关系曲线
    ├── 使用对数坐标轴
    └── 保存最终图形

main()                                # 主流程
    ├── 循环调用各K值计算
    ├── 调用绘图函数
    └── 输出统计信息
```

## 关键特性

### 1. 智能用户分布
- 根据用户数量自动优化位置分布
- 避免用户过于集中或分散
- 确保公平的覆盖范围

### 2. 功率扫描
- 发射功率范围：0.1W - 2.0W
- 50个采样点，确保平滑曲线
- 支持自定义功率范围

### 3. 总功率计算
- 计算所有用户的总接收功率
- 反映系统的整体性能
- 考虑多用户场景的实际需求

### 4. 对数坐标显示
- X轴使用对数坐标更好地显示功率变化
- 符合功率分析的常规做法
- 便于观察功率效率

### 5. 双对数图分析
- 双对数坐标显示功率与距离的数学关系
- 线性功率值便于观察绝对功率变化
- 适合分析路径损耗模型的数学特性

## 应用场景

1. **系统设计**：确定最优发射功率预算
2. **容量规划**：评估多用户系统性能
3. **资源分配**：优化功率分配策略
4. **性能对比**：比较不同用户数量的系统性能

## 扩展功能

代码支持以下自定义：
- 修改用户位置分布
- 调整发射功率范围
- 更改路径损耗指数
- 自定义环境边界
- 添加更多用户数量
